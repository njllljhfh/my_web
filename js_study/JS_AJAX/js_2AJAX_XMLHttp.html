<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AJAX - XMLHttpRequest 对象</title>
  <link rel="stylesheet" href="../style_sheet/my_style.css">
</head>
<body>
  <a href="https://www.w3school.com.cn/js/js_ajax_http.asp">AJAX - XMLHttpRequest 对象</a>
  <hr/>


  <div id="intro">
    <p><strong>Ajax 的核心是 XMLHttpRequest 对象。</strong></p>
  </div>
  <hr/>


  <div>
    <h2>XMLHttpRequest 对象</h2>
    <p>所有现代浏览器都支持 XMLHttpRequest 对象。</p>
    <p>XMLHttpRequest 对象用于同幕后服务器交换数据。这意味着可以更新网页的部分，而不需要重新加载整个页面。</p>
  </div>
  <hr/>


  <div>
    <h2>创建 XMLHttpRequest 对象</h2>
    <p>所有现代浏览器（Chrom、IE7+、Firefox、Safari 以及 Opera）都有内建的 XMLHttpRequest 对象。</p>
    <p>创建 XMLHttpRequest 的语法是：</p>
    <pre><i>variable</i> = new XMLHttpRequest();</pre>
    <p>老版本的 Internet Explorer（IE5 和 IE6）使用 ActiveX 对象：</p>
    <pre><i>variable</i> = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);</pre>
    <p>为了应对所有浏览器，包括 IE5 和 IE6，请检查浏览器是否支持 XMLHttpRequest 对象。如果支持，创建 XMLHttpRequest 对象，如果不支持，则创建 ActiveX 对象：</p>
    <pre>
var xhttp;
if (window.XMLHttpRequest) {
    xhttp = new XMLHttpRequest();
    } else {
    <span class="code_comment">// code for IE6, IE5</span>
     xhttp = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);
}
</pre>

    <h3>实例</h3>
    <p id="demo1">让 AJAX 改变这段文本。</p>
    <button type="button" onclick="loadDoc()">更改内容</button>
    <script>
      function loadDoc() {
        var xhttp;
        if (window.XMLHttpRequest) {
          // 用于现代浏览器的代码
          xhttp = new XMLHttpRequest();
        }
        else {
          // 应对老版本 IE 浏览器的代码
          xhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }

        xhttp.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
            document.getElementById("demo1").innerHTML = this.responseText;
          }
        };
        xhttp.open("GET", "https://www.w3school.com.cn/example/js/ajax_info.txt", true);
        xhttp.send();
      }
    </script>
  </div>
  <hr/>


</body>
</html>